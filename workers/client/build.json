{
    "tasks": [
        {
            "name": "Codegen",
            "steps": [
                {
                    "name": "C++",
                    "arguments": [
                        "process_schema",
                        "generate",
                        "--cachePath=../../.spatialos/schema_codegen_cache",
                        "--output=../../generated_code/cpp/schema",
                        "--language=cpp"
                    ]
                }
            ]
        },
        {
            "name": "Build",
            "steps": [
                {
                    "name": "Codegen",
                    "arguments": [
                        "invoke-task",
                        "Codegen"
                    ]
                },
                {
                    "name": "Install dependencies",
                    "arguments": [
                        "package",
                        "unpack"
                    ]
                },
                {
                    "name": "Client worker",
                    "command": "bazel",
                    "arguments": [
                        "build",
                        "//workers/client/src/...",
                        "-c",
                        "opt"
                    ]
                },
                {
                    "name": "Assembly",
                    "command": "./make_zip.sh",
                    "target": "linux"
                },
                {
                    "name": "Assembly",
                    "command": "powershell",
                    "arguments": [
                        ".\\make_zip.ps1"
                    ],
                    "target": "windows"
                }
            ]
        },
        {
            "name": "Clean",
            "steps": [
                {
                    "name": "Generated code",
                    "arguments": [
                        "process_schema",
                        "clean",
                        "--cachePath=../../.spatialos/schema_codegen_cache",
                        "../../.spatialos/schema_codegen_proto",
                        "../../generated_code/cpp/schema"
                    ]
                },
                {
                    "name": "Dependencies",
                    "arguments": [
                        "package",
                        "clean"
                    ]
                },
                {
                    "name": "Workers",
                    "command": "bazel",
                    "arguments": [
                        "clean"
                    ]
                }
            ]
        }
    ]
}
